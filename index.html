<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Tu Platica - Envío de Remesas</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#19223D">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    @media (min-width: 640px) {
      html, body {
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    }
    #installButton {
      touch-action: none; /* Enable drag on mobile */
    }
  </style>
</head>
<body class="bg-gray-100">
  <div class="w-full max-w-[400px] px-4 py-8 mx-auto">
    <!-- Header with logo -->
    <div class="text-center mb-4">
      <h1 class="text-3xl font-bold text-blue-900">Tu Platica</h1>
      <img src="icon.png" alt="Logo Tu Platica" class="mx-auto mb-4 w-24 h-auto">
    </div>
    
    <!-- Main content card -->
    <div class="bg-white p-6 rounded-lg shadow-md">
      <!-- Exchange Rate Cards Section -->
      <div class="flex flex-wrap gap-4 mb-6 overflow-x-auto pb-2">
        <!-- TuPlatica Official Card -->
        <div class="min-w-[250px] bg-white rounded-lg shadow border border-gray-200 flex-1">
          <div class="bg-blue-800 text-white p-3 rounded-t-lg">
            <h3 class="font-bold text-center">TuPlatica (Oficial)</h3>
            <p class="text-xs text-blue-100 text-center">TuPlatica</p>
          </div>
          <div class="p-4 text-center">
            <div class="flex justify-center mb-3">
              <svg class="w-12 h-12 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <p class="text-2xl font-bold text-gray-800 mb-2">Bs 36,50</p>
            <p class="text-xs text-gray-500 mb-3">16/05/2025 - 7:30 PM</p>
            <button class="px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">Oficial</button>
          </div>
        </div>

        <!-- BCV Card -->
        <div class="min-w-[250px] bg-white rounded-lg shadow border border-gray-200 flex-1">
          <div class="bg-blue-800 text-white p-3 rounded-t-lg">
            <h3 class="font-bold text-center">Oficial</h3>
            <p class="text-xs text-blue-100 text-center">Dólar BCV</p>
          </div>
          <div class="p-4 text-center">
            <div class="flex justify-center mb-3">
              <svg class="w-12 h-12 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <p class="text-2xl font-bold text-gray-800 mb-2">Bs 36,25</p>
            <p class="text-xs text-gray-500 mb-3">16/05/2025 - 7:30 PM</p>
            <button class="px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">Ver</button>
          </div>
        </div>

        <!-- Parallel Market Card -->
        <div class="min-w-[250px] bg-white rounded-lg shadow border border-gray-200 flex-1">
          <div class="bg-blue-800 text-white p-3 rounded-t-lg">
            <h3 class="font-bold text-center">Promedio</h3>
            <p class="text-xs text-blue-100 text-center">EnParaleloVzla</p>
          </div>
          <div class="p-4 text-center">
            <div class="flex justify-center mb-3">
              <svg class="w-12 h-12 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <p class="text-2xl font-bold text-gray-800 mb-2">Bs 37,10</p>
            <p class="text-xs text-gray-500 mb-3">16/05/2025 - 7:30 PM</p>
            <button class="px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">Ver</button>
          </div>
        </div>
      </div>
      
      <!-- USD Amount Field -->
      <div class="mb-4">
        <label for="usdAmount" class="block text-sm font-medium text-gray-700 mb-1">Monto en USD</label>
        <div class="flex gap-2">
          <input id="usdAmount" type="number" step="0.01" min="0" max="200"
            class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Ej: 100">
          
          <!-- Result Display -->
          <div id="vesResult" class="flex-1 px-3 py-2 text-green-600 font-medium">
            💰 0 Bs
          </div>
        </div>
        
        <!-- Commission Display -->
        <div id="commissionResult" class="mt-2 text-blue-600 font-medium">
          💸 Total a depositar: 0.00 USD (incluye comisión)
        </div>
        
        <!-- Warning Message -->
        <div id="amountWarning" class="hidden mt-2 text-red-600 text-sm flex items-start gap-1">
          <span>⚠️</span>
          <span>El monto máximo permitido es 200 USD</span>
        </div>
      </div>
      
      <!-- Current Rate (hidden reference) -->
      <div id="currentRate" class="hidden">36.50</div>
      
      <!-- Zelle info toggle -->
      <button id="zelleToggleBtn" class="w-full bg-yellow-400 hover:bg-yellow-500 text-yellow-900 font-medium py-3 px-4 rounded-full mb-4 transition duration-150 ease-in-out">
        ¿A dónde transfiero el Zelle?
      </button>
      
      <!-- Zelle info (hidden by default) -->
      <div id="zelleInfo" class="hidden mt-2 p-3 bg-white rounded shadow text-center border border-yellow-200">
        <p class="text-sm">Correo Zelle: <span id="correoZelle" class="font-medium">tuplatica@gmail.com</span></p>
        <button id="copyZelleBtn" class="mt-2 px-4 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
          Copiar
        </button>
      </div>
      
      <!-- Sender info -->
      <div>
        <label for="sender" class="block text-sm font-medium text-gray-700 mb-1">¿Quién envía?</label>
        <input type="text" id="sender" required
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>
      
      <!-- Payment proof -->
      <div>
        <label for="paymentProof" class="block text-sm font-medium text-gray-700 mb-1">Sube el comprobante de Zelle o transferencia</label>
        <input type="file" id="paymentProof" accept=".jpg,.jpeg,.png,.pdf" required
          class="w-full px-3 py-2 text-sm text-gray-700 border border-gray-300 rounded-md file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
      </div>
      
      <!-- Recipient info -->
      <div>
        <label for="recipient" class="block text-sm font-medium text-gray-700 mb-1">Nombre del destinatario</label>
        <input type="text" id="recipient" required
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>
      
      <!-- Recipient bank info -->
      <div>
        <label for="bankInfo" class="block text-sm font-medium text-gray-700 mb-1">Banco o pago móvil del destinatario</label>
        <input type="text" id="bankInfo" required
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>
      
      <!-- Save recipient button (shown when fields have content) -->
      <div id="saveRecipientContainer" class="hidden mt-2">
        <button id="saveRecipientBtn" class="w-full py-2 px-4 bg-green-100 text-green-800 rounded-md hover:bg-green-200 flex items-center justify-center gap-2">
          👉 Guardar este destinatario como frecuente
        </button>
      </div>
      
      <!-- Additional notes -->
      <div>
        <label for="notes" class="block text-sm font-medium text-gray-700 mb-1">Notas adicionales (opcional)</label>
        <input type="text" id="notes" maxlength="100" placeholder="Máximo 100 caracteres"
          class="w-full px-2 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>
      
      <!-- WhatsApp number -->
      <div>
        <label for="whatsapp" class="block text-sm font-medium text-gray-700 mb-1">Tu número de WhatsApp</label>
        <div class="flex gap-2">
          <select id="countryCode" class="w-1/3 px-2 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="+1">🇺🇸 +1 (EE.UU.)</option>
            <option value="+58" selected>🇻🇪 +58 (Venezuela)</option>
            <option value="+57">🇨🇴 +57 (Colombia)</option>
            <option value="+51">🇵🇪 +51 (Perú)</option>
            <option value="+56">🇨🇱 +56 (Chile)</option>
          </select>
          <input type="tel" id="whatsapp" required
            class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Número sin código">
        </div>
        <p class="text-xs text-gray-500 mt-1">Ejemplo: 4121234567</p>
      </div>
      
      <!-- Frequent recipients dropdown (shown when recipients exist) -->
      <div id="recipientsDropdownContainer" class="hidden mt-6">
        <label class="block text-sm font-medium text-gray-700 mb-1">👉 Selecciona un destinatario frecuente</label>
        <select id="savedRecipients" class="w-full px-3 py-2 border border-gray-300 rounded-md">
          <option value="">-- Seleccionar --</option>
        </select>
      </div>
      
      <!-- Clear recipients button -->
      <div class="mt-4 text-center">
        <button id="clearRecipientsBtn" class="text-sm text-red-600 hover:text-red-800">
          👉 Eliminar todos los destinatarios guardados
        </button>
      </div>
      
      <!-- Submit button -->
      <button type="submit"
        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-150 ease-in-out">
        Enviar solicitud
      </button>
    </form>
    
    <!-- Success message (hidden by default) -->
    <div id="successMessage" class="hidden mt-4 p-4 bg-green-50 text-green-700 rounded-md text-center">
      <p>✅ Tu solicitud fue enviada con éxito. Te responderemos pronto por WhatsApp.</p>
    </div>
  </div>
  
  <script>
    // Close button functionality
    document.getElementById('closeInstallInfo').addEventListener('click', () => {
      document.getElementById('installInfoBox').style.display = 'none';
      localStorage.setItem('hideInstallInfo', 'true');
    });
    
    // Check if user previously closed the box
    if (localStorage.getItem('hideInstallInfo') === 'true') {
      document.getElementById('installInfoBox').style.display = 'none';
    }
  </script>
  
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(registration => console.log('SW registered: ', registration))
          .catch(err => console.log('SW registration failed: ', err));
      });
    }
  </script>
</body>
</html>
